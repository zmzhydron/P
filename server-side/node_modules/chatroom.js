var wserver = require('ws').Server,
	ws = new wserver({port:8889});


ws.on('connection',function(ws){
	console.log('new part join the chatroom!')
	ws.on('message',function(message){
		console.log(message);
		try{

			var obj = JSON.parse(message);
			console.log(obj);
			var data = 'user: '+obj.user+" say: "+obj.data;
			// ws.send();
			console.log(ws.clients);
			// ws.broadcast(data);
		}catch(e){
			throw 'must input a json or json like string';
		}

	})
})
ws.broadcast = function broadcast(data) {
	console.log("broadcast")
  ws.clients.forEach(function each(client) {
    client.send(data);
  });
};
var exp = {
	addUser:function(){
		
	},
	createServer:function(){

	}
} 


module.exports = exp;